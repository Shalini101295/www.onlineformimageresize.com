# Excel Visualizer - Enhanced File Access

# Protect user authentication files
<Files "secure_users.txt">
    Order deny,allow
    Deny from all
</Files>

<Files "auth_log.txt">
    Order deny,allow
    Deny from all
</Files>

<Files "login_attempts.txt">
    Order deny,allow
    Deny from all
</Files>

# Protect project management files
<Files "projects_index.txt">
    Order deny,allow
    Deny from all
</Files>

<Files "project_log.txt">
    Order deny,allow
    Deny from all
</Files>

<Files "file_upload_log.txt">
    Order deny,allow
    Deny from all
</Files>

<Files "file_download_log.txt">
    Order deny,allow
    Deny from all
</Files>

# Allow Excel files in user_projects directory
<LocationMatch "^/.*user_projects/.*\.(xlsx|xls)$">
    Order allow,deny
    Allow from all
</LocationMatch>

# Protect other files in user_projects (metadata, configs, etc.)
<LocationMatch "^/.*user_projects/.*\.(json|txt|log|php)$">
    Order deny,allow
    Deny from all
</LocationMatch>

# Allow PHP files to execute
<Files "*.php">
    Allow from all
</Files>

# Allow HTML and CSS files
<Files "*.html">
    Allow from all
</Files>

<Files "*.css">
    Allow from all
</Files>

<Files "*.js">
    Allow from all
</Files>

# Prevent access to backup and config files
<Files "*.bak">
    Order deny,allow
    Deny from all
</Files>

<Files "*.old">
    Order deny,allow
    Deny from all
</Files>

<Files "*.tmp">
    Order deny,allow
    Deny from all
</Files>

# Basic security headers
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options SAMEORIGIN
    Header always set X-XSS-Protection "1; mode=block"
    
    # Allow CORS for Excel files from same origin
    <FilesMatch "\.(xlsx|xls)$">
        Header set Access-Control-Allow-Origin "*"
        Header set Access-Control-Allow-Methods "GET, POST, OPTIONS"
        Header set Access-Control-Allow-Headers "Content-Type"
    </FilesMatch>
</IfModule>

# Optional: Enable compression for better performance
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/json
</IfModule>